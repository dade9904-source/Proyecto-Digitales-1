-- tb_DisplayDriver.vhd (solo vectores sseg1..sseg4 en Waves)
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.NUMERIC_STD.ALL;

entity tb_DisplayDriver is
end entity;

architecture sim of tb_DisplayDriver is
  -- DUT
  component ProyectoDigitales
    port(
      A        : in  STD_LOGIC_VECTOR(3 downto 0);
      B        : in  STD_LOGIC_VECTOR(3 downto 0);
      Operator : in  STD_LOGIC_VECTOR(1 downto 0); -- 00=suma (irrelevante para validación)
      sseg1    : out STD_LOGIC_VECTOR(6 downto 0);
      sseg2    : out STD_LOGIC_VECTOR(6 downto 0);
      sseg3    : out STD_LOGIC_VECTOR(6 downto 0);
      sseg4    : out STD_LOGIC_VECTOR(6 downto 0)
    );
  end component;

  -- Estímulos
  signal A        : STD_LOGIC_VECTOR(3 downto 0) := (others=>'0');
  signal B        : STD_LOGIC_VECTOR(3 downto 0) := (others=>'0');
  signal Operator : STD_LOGIC_VECTOR(1 downto 0) := "00"; -- fijo

  -- Salidas a observar en Waves
  signal sseg1, sseg2, sseg3, sseg4 : STD_LOGIC_VECTOR(6 downto 0);
begin
  -- Instancia del DUT
  UUT: ProyectoDigitales
    port map(
      A        => A,
      B        => B,
      Operator => Operator,
      sseg1    => sseg1,
      sseg2    => sseg2,
      sseg3    => sseg3,
      sseg4    => sseg4
    );

  -- Estímulos: validación de entradas
  stim : process
    constant STEP : time := 10 ns;
  begin
    -- Barrido A = 0..9 con B=0
    B <= "0000";
    for a_i in 0 to 9 loop
      A <= std_logic_vector(to_unsigned(a_i, 4));
      wait for STEP;
    end loop;

    -- A inválidos: 10, 11, 12
    for a_i in 10 to 12 loop
      A <= std_logic_vector(to_unsigned(a_i, 4)); -- 1010, 1011, 1100
      wait for STEP;
    end loop;

    -- Barrido B = 0..9 con A=0
    A <= "0000";
    for b_i in 0 to 9 loop
      B <= std_logic_vector(to_unsigned(b_i, 4));
      wait for STEP;
    end loop;

    -- B inválidos: 10, 11, 12
    for b_i in 10 to 12 loop
      B <= std_logic_vector(to_unsigned(b_i, 4));
      wait for STEP;
    end loop;

    -- Ambos inválidos (opcional)
    A <= "1010"; B <= "1100"; wait for STEP;

    -- Fin de simulación
    wait for 20 ns;
    assert false report "Fin de simulacion (tb_DisplayDriver)" severity failure;
  end process;

end architecture;
